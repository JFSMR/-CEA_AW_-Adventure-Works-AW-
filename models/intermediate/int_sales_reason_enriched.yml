version: 2

models:
  - name: int_sales_reason_enriched
    description: >
      Tabela intermediária que combina pedidos de venda com as razões correspondentes.
      Representa uma junção entre os fatos de pedidos e a dimensão de razões de venda.

    columns:
      - name: sales_order_pk
        description: Chave estrangeira do pedido de venda.
        tests:
          - not_null

      - name: sales_reason_id
        description: Chave estrangeira da razão de venda. Derivada de sales_reason_fk.
        # Remover o not_null se mantiver LEFT JOIN
        # tests:
        #   - not_null

      - name: name_reason
        description: Nome descritivo da razão de venda (e.g., Promotion, Marketing).

      - name: type_reason
        description: Tipo ou categoria da razão de venda.

    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - sales_order_pk
            - sales_reason_id
