

models:
  - name: sales_order_facts
    description: |
      Intermediate model that consolidates sales order data, item details,
      sales reasons, and calculates financial metrics such as gross_sales_value and net_sales_value.
    columns:
      - name: sales_item_pk
        description: Primary key of the sales order item.
        tests:
          - unique
          - not_null

      - name: sales_order_detail_pk
        description: Primary key of the sales order detail.
        tests:
          - unique
          - not_null

      - name: sales_order_fk
        description: Foreign key to the sales order.
        tests:
          - not_null

      - name: product_fk
        description: Foreign key to the sold product.
        tests:
          - not_null

      - name: order_quantity
        description: Quantity of the product ordered.
        tests:
          - not_null
          - accepted_values:
              values: ['>0']  # DBT doesn't have this type, but test can be customized in SQL

      - name: unit_price
        description: Unit price of the product in the order.
        tests:
          - not_null

      - name: unitpricediscount
        description: Discount applied on the unit price (value between 0 and 1).
        tests:
          - not_null

      - name: customer_fk
        description: Foreign key to the customer who placed the order.
        tests:
          - not_null

      - name: territory_fk
        description: Foreign key to the sales territory.
        tests:
          - not_null

      - name: order_date
        description: Date when the order was placed.
        tests:
          - not_null

      - name: sales_reason_fk
        description: Foreign key to the sales reason.
        tests:
          - not_null

      - name: gross_sales_value
        description: Gross sales value calculated as unit_price * order_quantity.
        tests:
          - not_null

      - name: net_sales_value
        description: Net sales value, discount applied on the unit price.
        tests:
          - not_null

      - name: order_count
        description: Order count, always 1 per row.
        tests:
          - not_null
